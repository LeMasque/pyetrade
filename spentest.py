#!/usr/bin/env python3

import pyetrade
import json

from pyetrade.etrade import ETrade
from pyetrade.authorization.oauth import ETradeOAuth

with open('config.json', 'r') as infile:
    config = json.loads(infile.read())

etrade_dev = config['api_info']['etrade']['dev']

oauth_consumer_key = etrade_dev['oauth_consumer_key']
oauth_consumer_secret = etrade_dev['oauth_consumer_secret']

oauth = ETradeOAuth(auth_info=(oauth_consumer_key, oauth_consumer_secret, '', ''))

print('Please go here to authorize: {}'.format(oauth.get_request_token()))
verifier = input('verifier: ')
ro_key, ro_secret = oauth.get_access_token(verifier)

auth_info = (oauth_consumer_key, oauth_consumer_secret, ro_key, ro_secret)
accounts = pyetrade.ETradeAccounts(auth_info=auth_info)
print(accounts.list_accounts())

#et = ETrade(('a', 'b', 'c', 'd'))
#print(et.make_url(
#    module='test',
#    action='act',
#    response_type='json'
#))
